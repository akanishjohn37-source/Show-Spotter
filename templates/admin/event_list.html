{% extends 'base.html' %}

{% block title %}All Events{% endblock %}

{% block content %}
<div style="margin-bottom: 2rem;">
    <a href="{% url 'admin_dashboard' %}" class="btn-text">&larr; Back to Dashboard</a>
</div>

<h1 style="margin-bottom: 2rem;">System Events Overview</h1>

{% if event_stats %}
<div style="overflow-x: auto;">
    <table
        style="width: 100%; border-collapse: collapse; background: var(--surface); border-radius: 8px; overflow: hidden;">
        <thead>
            <tr style="background: #333; text-align: left;">
                <th style="padding: 1rem;">Event Title</th>
                <th style="padding: 1rem;">Host</th>
                <th style="padding: 1rem;">Date</th>
                <th style="padding: 1rem;">Total Revenue</th>
                <th style="padding: 1rem;">Capacity</th>
                <th style="padding: 1rem;">Booked</th>
                <th style="padding: 1rem;">Available</th>
                <th style="padding: 1rem;">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for item in event_stats %}
            <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                <td style="padding: 1rem; font-weight: bold;">{{ item.event.title }}</td>
                <td style="padding: 1rem;">{{ item.event.host.username }}</td>
                <td style="padding: 1rem;">{{ item.event.date }}</td>
                <td style="padding: 1rem; color: var(--accent);">${{ item.revenue }}</td>
                <td style="padding: 1rem;">{{ item.total_capacity }}</td>
                <td style="padding: 1rem;">{{ item.booked_count }}</td>
                <td style="padding: 1rem; font-weight: bold;">{{ item.balance_seats }}</td>
                <td style="padding: 1rem;">
                    <form action="{% url 'delete_event' item.event.id %}" method="post"
                        onsubmit="return confirm('Are you sure you want to delete this event? This cannot be undone.');"
                        style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" class="btn"
                            style="background-color: #ff4444; padding: 0.5rem 1rem; font-size: 0.8rem;">Delete</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="card" style="text-align: center; padding: 3rem;">
    <p style="color: var(--text-muted); font-size: 1.2rem;">No events found in the system.</p>
</div>
{% endif %}
{% endblock %}